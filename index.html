<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>JSpec - JavaScript Testing Framework</title>
    <link href='style.css' rel='stylesheet' />
    <link href='lightr.css' rel='stylesheet' />
    <script src='javascripts/jquery.js'></script>
    <script src='javascripts/app.js'></script>
  </head>
  <body>
    <a href='http://github.com/visionmedia/jspec'>
      <img alt='Fork me on GitHub' id='ribbon' src='http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png' />
    </a>
  </body>
  <div id='container'>
    <div id='download'>
      <a href='http://github.com/visionmedia/jspec/downloads'>
        <img src='http://github.com/images/modules/download/zip.png' />
      </a>
      <a href='http://github.com/visionmedia/jspec/downloads'>
        <img src='http://github.com/images/modules/download/tar.png' />
      </a>
    </div>
    <h1>JSpec <em>JavaScript Testing Framework</em></h1>
    <p>
      JSpec is a extremely small, yet very powerful testing framework. Utilizing its own custom grammar and
      pre-processor, JSpec can operate in ways that no other JavaScript testing framework can. This includes
      many helpful shorthand literals, a very intuitive / readable syntax, as well as not polluting core
      object prototypes.
    </p>
    <p>
      JSpec can also be run suites in a variety of ways, such as via the terminal with Rhino support, via browsers
      using the DOM or Console formatters, or finally by using the Ruby JavaScript server which
      runs browsers in the background, reporting back to the terminal.
    </p>
    <div id='features'>
      <h2>Features</h2>
      <ul>
        <li>Allows parens to be optional when using matchers to increase readability</li>
        <li>Assertion graphs displaying how many, and which assertions passed or failed</li>
        <li>Async support</li>
        <li>Envjs support</li>
        <li>Mock Ajax</li>
        <li>Fixture support</li>
        <li>Modular extensibility via Modules and hooks.</li>
        <li>Cascading before/after/before_each/after_each hooks</li>
        <li>Default / customizable evaluation contexts</li>
        <li>Does not pollute core object prototypes or global scope</li>
        <li>DOM sandbox support</li>
        <li>Extremely simple and intuitive matcher declaration</li>
        <li>Framework / DOM independent</li>
        <li>Grammar-less option (for those who dislike JSpec's syntax)</li>
        <li>Great looking default DOM theme</li>
        <li>Highly readable custom grammar</li>
        <li>Nested describes</li>
        <li>Optionally display failures only, speeding up development</li>
        <li>Over 45 core matchers</li>
        <li>Profiling</li>
        <li>Proxy assertion or 'spy' support</li>
        <li>Method Stubbing</li>
        <li>Rhino support</li>
        <li>Ruby JavaScript testing server</li>
        <li>Several helpful formatters (dom, console, terminal, ...)</li>
        <li>Shared behaviors</li>
        <li>Ruby on Rails Integration</li>
        <li>Tiny (15 kb compressed, 1600-ish LOC)</li>
        <li>`jspec` command-line utility for auto-running specs, and initializing project templates</li>
      </ul>
    </div>
    <div id='screencasts'>
      <a href='#' name='screencasts'>      </a>
      <h2>Screencasts</h2>
      <ul>
        <li>
          <a href='http://content.screencast.com/users/tjholowaychuk/folders/Jing/media/816a8baa-0175-491a-a138-c889fff99f2d/00000077.swf'>JSpec Introduction:</a>
          Learn how to set up your own JSpec project and get testing.
        </li>
        <li>
          <a href='http://content.screencast.com/users/tjholowaychuk/folders/Jing/media/cef7b41f-976e-4841-b37f-c4d2f6e37639/00000078.swf'>Hooks:</a>
          Clean up suites using JSpec's cascading before/after hooks
        </li>
        <li>
          <a href='http://content.screencast.com/users/tjholowaychuk/folders/Jing/media/488587de-1d82-4bdf-8880-4247a358fdec/00000079.swf'>Running Suites:</a>
          Run JSpec suites using the DOM, Rhino, Ruby server and more.
        </li>
        <li>
          <a href='http://content.screencast.com/users/tjholowaychuk/folders/Jing/media/3532baed-e21a-4ce3-a5e9-fa1f5f447621/00000080.swf'>Grammar:</a>
          Learn about JSpec's custom grammar or 'DSL', how it works and what it provides.
        </li>
        <li>
          <a href='http://content.screencast.com/users/tjholowaychuk/folders/Jing/media/17a10faf-5bc3-42ff-81bb-edb111c8261a/00000081.swf'>Fixtures / DOM Testing:</a>
          Cleanly test DOM elements using fixtures and jQuery.
        </li>
      </ul>
    </div>
    <div id='example'>
      <h2>Example</h2>
      <code class='highlight'>describe <span class="string">'ShoppingCart'</span>&#x000A; <span class="keyword"> before_each&#x000A;</span>    cart =<span class="keyword"> new </span><span class="constant">ShoppingCart</span>&#x000A; <span class="keyword"> end&#x000A;</span>  &#x000A; <span class="keyword"> describe </span><span class="string">'addProduct'</span>&#x000A;   <span class="keyword"> it </span><span class="string">'should add a product'</span>&#x000A;      cart.addProduct(<span class="string">'cookie'</span>)&#x000A;      cart.addProduct(<span class="string">'icecream'</span>)&#x000A;      cart.should.have <span class="number int">2</span>, <span class="string">'products'</span>&#x000A;   <span class="keyword"> end&#x000A;</span> <span class="keyword"> end&#x000A;</span>&#x000A; <span class="keyword"> describe </span><span class="string">'addProducts'</span>&#x000A;   <span class="keyword"> it </span><span class="string">'should add several products'</span>&#x000A;      cart.should.receive(<span class="string">'addProduct'</span>, <span class="string">'twice'</span>).with_args(an_instance_of(<span class="constant">String</span>))&#x000A;      cart.addProducts(<span class="string">'cookie'</span>, <span class="string">'icecream'</span>)&#x000A;   <span class="keyword"> end&#x000A;</span> <span class="keyword"> end&#x000A;</span>&#x000A; <span class="keyword"> describe </span><span class="string">'checkout'</span>&#x000A;   <span class="keyword"> it </span><span class="string">'throw an error when checking out with no products'</span>&#x000A;      -{ cart.clear().checkout() }.should.throw_error <span class="constant">CheckoutError</span>, <span class="string">'No products'</span>&#x000A;   <span class="keyword"> end&#x000A;</span> <span class="keyword"> end&#x000A;</span>end</code>
      <h2>DOM Formatter</h2>
      <p>The DOM formatter is the default of JSpec, featuring assertion graphs and a sleek white style.</p>
      <img alt='JSpec DOM Formatter' class='rounded' src='http://img396.imageshack.us/img396/8868/jspecdom.png' />
    </div>
    <div id='matchers'>
      <h2>Matchers</h2>
      <pre id='matcher-example'>Click a matcher below to view an example</pre>
      <div class='left'>
        <h3>Core</h3>
        <ul class='matchers'>
          <li>be</li>
          <li>eql</li>
          <li>equal</li>
          <li>be_a</li>
          <li>be_an</li>
          <li>be_an_instance_of</li>
          <li>be_at_least</li>
          <li>be_at_most</li>
          <li>be_within</li>
          <li>be_null</li>
          <li>be_undefined</li>
          <li>be_empty</li>
          <li>be_true</li>
          <li>be_false</li>
          <li>be_type</li>
          <li>be_greater_than</li>
          <li>be_less_than</li>
          <li>have</li>
          <li>have_at_least</li>
          <li>have_at_most</li>
          <li>have_within</li>
          <li>have_length</li>
          <li>have_prop</li>
          <li>have_property</li>
          <li>include</li>
          <li>match</li>
          <li>throw_error</li>
          <li>respond_to</li>
        </ul>
      </div>
      <div class='right'>
        <h3>jQuery</h3>
        <ul class='matchers'>
          <li>have_tag</li>
          <li>have_one</li>
          <li>have_tags</li>
          <li>have_many</li>
          <li>have_child</li>
          <li>have_children</li>
          <li>have_text</li>
          <li>have_attr</li>
          <li>have_value</li>
          <li>have_class</li>
          <li>have_classes</li>
          <li>be_visible</li>
          <li>be_hidden</li>
          <li>be_enabled</li>
          <li>be_disabled</li>
          <li>be_selected</li>
          <li>be_checked</li>
          <li>have_type</li>
          <li>have_id</li>
          <li>have_title</li>
          <li>have_alt</li>
          <li>have_href</li>
          <li>have_src</li>
          <li>have_rel</li>
          <li>have_rev</li>
          <li>have_name</li>
          <li>have_target</li>
        </ul>
      </div>
      <div class='clear'></div>
    </div>
    <h2>JSpec Executable</h2>
    <p>The packaged JSpec executable allows you to quickly initialize project templates which utilize JSpec, update them with the lateast versions of JSpec, as well as auto-run suites in multiple browsers when a file is altered. For information beyond the examples below consult `jspec help`.</p>
    <pre class='small'># Initialize template in the current directory &#x000A;$ jspec init&#x000A;&#x000A;# Initialize template at ./myproject&#x000A;$ jspec init myproject</pre>
    <pre class='small'># Update to the lateast version of JSpec within your spec suite&#x000A;$ jspec update&#x000A;&#x000A;# Update a specific file&#x000A;$ jspec update spec/run-suites.html</pre>
    <pre class='small'># Refresh suites when any JavaScript is altered&#x000A;$ jspec&#x000A;&#x000A;# View help&#x000A;$ jspec help&#x000A;&#x000A;# View command specific help&#x000A;$ jspec help run&#x000A;&#x000A;# Run suites once in the default browser (Safari)&#x000A;$ jspec run&#x000A;&#x000A;# Run suites once in the browsers passed&#x000A;$ jspec run --browsers Firefox,Explorer,Opera&#x000A;&#x000A;# Alternate naming&#x000A;$ jspec run --browsers ff,ie,opera&#x000A;&#x000A;# Refresh suites when altered in a custom suite path, in several browsers&#x000A;$ jspec spec/run-suites.html --browsers Safari,Firefox&#x000A;&#x000A;# Run custom suite path once&#x000A;$jspec run spec/some-suite.html&#x000A;&#x000A;# Run Ruby server in several browsers (reports back to terminal)&#x000A;$ jspec run --server --browsers Safari,Opera,Firefox&#x000A;&#x000A;$ Lowercase works too!&#x000A;$ jspec run --server --browsers safari,opera,ff,chrome&#x000A;&#x000A;# Run Ruby server in all supported browsers&#x000A;$ jspec run --server&#x000A;&#x000A;# Run suites using Rhino&#x000A;$ jspec run --rhino</pre>
    <h2>Proxy Assertions or 'Spies'</h2>
    <p>JSpec's support for proxy assertions allows you to assert that a method is invoked a specific number of times, with specific arguments, returning specific results. In the example below, we assert that <strong>getDogs()</strong> calls <strong>getPets()</strong> with a string of <strong>'dogs'</strong>, and returns an array of dogs. All these assertions must pass in order for the spec to pass.</p>
    <pre class='small'>person.should.receive('getPets', 'once').with_args('dogs').and_return(an_instance_of(Array))&#x000A;dogs = person.getDogs()</pre>
    <p>The example below will fail, due to the method being called only once with a string.</p>
    <pre class='small'>person.should.receive('getPets', 'twice').with_args(an_instance_of(String))&#x000A;dogs = person.getPets('dogs') // Passes&#x000A;all  = person.getPets() // Fails</pre>
    <h2>Fixtures</h2>
    <p>JSpec's fixture support is simple, yet elegant and powerful. The fixture() utility works for both Rhino and browsers alike. Paths are resolved as follows:</p>
    <p>fixture('FILE')</p>
    <ul>
      <li>'FILE'</li>
      <li>'spec/FILE'</li>
      <li>'spec/fixtures/FILE'</li>
      <li>'spec/fixtures/FILE.html'</li>
    </ul>
    <p>This means that if you have an html fixture located at 'spec/fixtures/foo.html' you may simply call fixture('foo'), likewise when using other extensions you may simply use fixture('foo.json'). When fixtures reside in different directories this may be specified as well fixture('data/foo.html'), fixture('html/foo.html'), etc.</p>
    <h2>DOM Testing With jQuery</h2>
    <p>When using jQuery it is extremely simple to test how your library interacts with a mock DOM. As you can see below there is no need to add arbitrary elements to your suite HTML, jQuery's constructor will generate the elements from a string or fixture.</p>
    <pre class='small'>describe 'DOM'&#x000A;  before_each&#x000A;    // Load spec/fixtures/user-ul-list.html fixture&#x000A;    list = $(fixture('user-ul-list'))&#x000A;  end&#x000A;  &#x000A;  describe 'jQuery.hide()'&#x000A;    it 'hide elements'&#x000A;      list.hide().should.be_hidden&#x000A;    end&#x000A;  end&#x000A;end</pre>
    <p>
      Click to see an example spec suite from the
      <a href='http://gist.github.com/147831'>jQuery.inline-search.js plugin</a>
    </p>
    <h2>Mock Ajax Requests</h2>
    <p>jspec.xhr.js provides the mock_request() and unmock_request() utilities. unmock_request() is automatically called after each spec, so it is usually not called manually. unmock_request() simply restores the original XMLHttpRequest object. mock_request() is framework agnostic, however below it is shown in use with jQuery:</p>
    <pre class='small'>describe 'Something'&#x000A;  before_each&#x000A;    // type, status, and headers are optional&#x000A;    mock_request().and_return('{ foo: "bar" }', 'application/json', 200, { Accept: 'foo' })&#x000A;  end&#x000A;  &#x000A;  it 'should foo'&#x000A;    $.getJSON('foo', function(response){&#x000A;      response.foo.should.eql 'bar'&#x000A;    })&#x000A;  end&#x000A;end</pre>
    <h2>Async Support With Mock Timers</h2>
    <p>
      The JavaScript mock timer library
      <a href='http://github.com/visionmedia/js-mock-timers'>http://github.com/visionmedia/js-mock-timers</a>
      is bundled with JSpec and is located at 'lib/jspec.timers.js'.
    </p>
    <p>Timers return ids as expected, which may be terminated when passed to clearInterval() however mock timers</p>
    require manual scheduling and progression via the tick() function.
    <pre class='small'>setTimeout(function(){&#x000A;  alert('Wahoo!')&#x000A;}, 400)&#x000A;&#x000A;tick(200) // Nothing happens&#x000A;tick(400) // Wahoo!</pre>
    <p>When using setInterval(), providing a large millisecond increment to tick() all callbacks which have not had a change to 'catch up' may be called several times as conveyed in the example below.</p>
    <pre class='small'>progress = ''&#x000A;var id = setInterval(function(){&#x000A;  progress += '.'&#x000A;}, 100)&#x000A;&#x000A;tick(50),  print(progress) // ''&#x000A;tick(50),  print(progress) // '.'&#x000A;tick(100), print(progress) // '..'&#x000A;tick(100), print(progress) // '...'&#x000A;tick(300), print(progress) // '......'&#x000A;&#x000A;clearInterval(id)&#x000A;&#x000A;tick(800) // Nothing happens</pre>
    <p>Finally a practical example:</p>
    <pre class='small'>function poll(uri, fn) {&#x000A;  setInterval(fn || function() {&#x000A;    // ... xhr request&#x000A;  }, 2000)&#x000A;}&#x000A;&#x000A;describe 'poll()'&#x000A;  it 'should poll a uri every 2 seconds'&#x000A;    called = 0&#x000A;    poll('http://vision-media.ca', function(){&#x000A;      ++called&#x000A;    })&#x000A;    tick(8000)&#x000A;    called.should.eql 4&#x000A;  end&#x000A;end</pre>
    <h2>Extending JSpec With Modules</h2>
    <p>JSpec's Modules take the form of a simple JavaScript object or 'hash', allowing you to add matchers</p>
    define dependencies, add utility functions, implement hook callbacks and more. Below is an example module
    taken from core to add jQuery support. Consult the README for additional information.
    <pre class='small'>// JSpec - jQuery - Copyright TJ Holowaychuk &lt;tj@vision-media.ca&gt; (MIT Licensed)&#x000A;&#x000A;JSpec&#x000A;.requires(&#39;jQuery&#39;, &#39;when using jspec.jquery.js&#39;)&#x000A;.include({&#x000A;  &#x000A;  // --- Initialize&#x000A;  &#x000A;  init : function() {&#x000A;    jQuery.ajaxSetup({ async : false })&#x000A;  },&#x000A;  &#x000A;  // --- Utilities&#x000A;  &#x000A;  utilities : {&#x000A;    element : jQuery,&#x000A;    elements : jQuery,&#x000A;    sandbox : function() {&#x000A;      return jQuery(&#39;&lt;div class=&quot;sandbox&quot;&gt;&lt;/div&gt;&#39;)&#x000A;    }&#x000A;  },&#x000A;  &#x000A;  // --- Matchers&#x000A;  &#x000A;  matchers : {&#x000A;    have_tag      : &quot;jQuery(expected, actual).length == 1&quot;,&#x000A;    have_one      : &quot;alias have_tag&quot;,&#x000A;    have_tags     : &quot;jQuery(expected, actual).length &gt; 1&quot;,&#x000A;    have_many     : &quot;alias have_tags&quot;,&#x000A;    have_child    : &quot;jQuery(actual).children(expected).length == 1&quot;,&#x000A;    have_children : &quot;jQuery(actual).children(expected).length &gt; 1&quot;,&#x000A;    have_text     : &quot;jQuery(actual).text() == expected&quot;,&#x000A;    have_value    : &quot;jQuery(actual).val() == expected&quot;,&#x000A;    be_enabled    : &quot;!jQuery(actual).attr(&#39;disabled&#39;)&quot;,&#x000A;    have_class    : &quot;jQuery(actual).hasClass(expected)&quot;,&#x000A;    &#x000A;    be_visible : function(actual) {&#x000A;      return jQuery(actual).css(&#39;display&#39;) != &#39;none&#39; &amp;&amp;&#x000A;             jQuery(actual).css(&#39;visibility&#39;) != &#39;hidden&#39; &amp;&amp;&#x000A;             jQuery(actual).attr(&#39;type&#39;) != &#39;hidden&#39;&#x000A;    },&#x000A;    &#x000A;    be_hidden : function(actual) {&#x000A;      return !JSpec.does(actual, &#39;be_visible&#39;)&#x000A;    },&#x000A;&#x000A;    have_classes : function(actual) {&#x000A;      return !JSpec.any(JSpec.argumentsToArray(arguments, 1), function(arg){&#x000A;        return !JSpec.does(actual, &#39;have_class&#39;, arg)&#x000A;      })&#x000A;    },&#x000A;&#x000A;    have_attr : function(actual, attr, value) {&#x000A;      return value ? jQuery(actual).attr(attr) == value:&#x000A;                     jQuery(actual).attr(attr)&#x000A;    },&#x000A;    &#x000A;    &#39;be disabled selected checked&#39; : function(attr) {&#x000A;      return &#39;jQuery(actual).attr(&quot;&#39; + attr + &#39;&quot;)&#39;&#x000A;    },&#x000A;    &#x000A;    &#39;have type id title alt href src sel rev name target&#39; : function(attr) {&#x000A;      return function(actual, value) {&#x000A;        return JSpec.does(actual, &#39;have_attr&#39;, attr, value)&#x000A;      }&#x000A;    }&#x000A;  }&#x000A;})</pre>
    <h2>Module Hooks</h2>
    <p>Hooks are called throughout JSpec's execution to provide modles with a chance to alter, or act upon</p>
    what is currently being processed. For example to add range support to JSpec we can simply implement a
    hook callback for the 'preprocessing' hook:
    <p>This implementation would allow '0..5' to be expanded to '[0,1,2,3,4,5]'</p>
    <pre class='small'>JSpec.include({&#x000A;  preprocessing : function(input) {&#x000A;    return input.replace(/(\d+)\.\.(\d+)/g, function(_, start, end){&#x000A;      var current = parseInt(start), end = parseInt(end), values = [current]&#x000A;      if (end > current) while (++current <= end) values.push(current)&#x000A;      else               while (--current >= end) values.push(current)&#x000A;      return '[' + values + ']'&#x000A;    })&#x000A;  }&#x000A;})</pre>
    <div id='more-information'>
      <h2>More Information</h2>
      <ul>
        <li>
          IRC Channel
          <a href='irc://irc.freenode.net#jspec'>irc://irc.freenode.net#jspec</a>
        </li>
        <li>
          Get the
          <a href='http://github.com/visionmedia/jspec.tmbundle/tree/master'>TextMate bundle</a>
        </li>
        <li>
          View the
          <a href='http://github.com/visionmedia/jspec'>Readme</a>
          for more documentation
        </li>
        <li>
          <a href='rails.html'>Rails / JSpec Integration</a>
        </li>
        <li>
          <a href='https://github.com/visionmedia/jspec-drupal'>Drupal / JSpec Integration</a>
        </li>
        <li>
          <a href='http://www.jsmag.com/main.issues.description/id=21/'>Featured JSpec Article in JSMag</a>
        </li>
        <li>
          <a href='http://github.com/thatcher/env-js'>Env.js</a>
        </li>
      </ul>
    </div>
    <h2>Authors</h2>
    <p>
      TJ Holowaychuk
      <a href='http://vision-media.ca'>(tj@vision-media.ca)</a>
    </p>
    <div class='footer'>
      this mini site brought to you by :
      <a href='http://github.com/visionmedia/mini'>visionmedia/mini</a>
    </div>
  </div>
</html>
